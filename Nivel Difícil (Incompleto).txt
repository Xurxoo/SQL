26)
SELECT
	M.MOVIE_NAME,
	N.NATIONALITY_ID,
	D.DIRECTOR_NAME
FROM
	MOVIES M
JOIN NATIONALITIES N ON
	M.NATIONALITY_ID = N.NATIONALITY_ID
JOIN DIRECTORS D ON M.DIRECTOR_ID = D.DIRECTOR_ID;

27)
SELECT
	M.MOVIE_NAME,
	GROUP_CONCAT(A.ACTOR_NAME SEPARATOR ', ') AS "ACTORES"
FROM
	MOVIES M
JOIN (
	SELECT
		ACTORS.ACTOR_NAME,
		ACTORS.ACTOR_ID,
		MOVIES_ACTORS.MOVIE_ID
	FROM
		MOVIES_ACTORS
	JOIN ACTORS ON
		MOVIES_ACTORS.ACTOR_ID = ACTORS.ACTOR_ID) A
	ON M.MOVIE_ID = A.MOVIE_ID
	GROUP BY A.MOVIE_NAME;
	
28)
 SELECT
	D.DIRECTOR_NAME
FROM
	DIRECTORS D
JOIN
	MOVIES M
ON D.DIRECTOR_ID = M.DIRECTOR_ID 
JOIN MEMBERS_MOVIE_RENTAL MR
ON M.MOVIE_ID = MR.MOVIE_ID 
GROUP BY D.DIRECTOR_NAME
ORDER BY COUNT(D.DIRECTOR_NAME) DESC
LIMIT 1;

29)
SELECT 
	S.STUDIO_NAME,	
	SUM(A.AWARD_WIN) AS "PREMIOS"
FROM 
	STUDIOS S
JOIN
	MOVIES M
	ON
	S.STUDIO_ID = M.STUDIO_ID
	JOIN 
	AWARDS A
	ON
	M.MOVIE_ID = A.MOVIE_ID	
GROUP BY
	S.STUDIO_NAME;

30)
SELECT	
	A.ACTOR_NAME AS "ACTOR",
	SUM(P.PREMIOS) AS "PREMIOS NO CONSEGUIDOS"
FROM
	(
	SELECT
		M.MOVIE_ID AS "MOVIE_ID",
		SUM(AW.AWARD_NOMINATION)-SUM(AW.AWARD_WIN) AS "PREMIOS"
	FROM
		MOVIES M
	JOIN
	AWARDS AW
	ON
		M.MOVIE_ID = AW.MOVIE_ID
	GROUP BY
		M.MOVIE_ID) P
JOIN
(
	SELECT
		A.ACTOR_NAME AS "ACTOR_NAME",
		A.ACTOR_ID AS "ACTOR_ID",
		MA.MOVIE_ID AS "MOVIE_ID"
	FROM
		ACTORS A
	JOIN MOVIES_ACTORS MA 
ON
		A.ACTOR_ID = MA.ACTOR_ID) A
ON P.MOVIE_ID = A.MOVIE_ID
GROUP BY A.ACTOR_NAME
